<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pubsub-js/1.6.0/pubsub.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tracking.js/1.1.3/tracking-min.js"></script>       
       
        <script src="app/scripts/auxiliar-de-sugestoes-de-palavras.js"></script>
        <script src="app/scripts/auxiliar-de-anotacoes.js"></script>
        <script src="app/scripts/auxiliar-de-placa.js"></script>        
        <script src="relogio.js"></script>
        <link rel="stylesheet" href="style.css">
        <script>

        $(() => {
            navigator.getUserMedia (
            // constraints
            {
                video: true,
                audio: false
            },

            // successCallback
            (localMediaStream) => {
                $('.video').prop('src', window.URL.createObjectURL(localMediaStream)).bind('loadedmetadata', () => {

                    var colors = new tracking.ColorTracker(['magenta']);

                    colors.on('track', function(event) {
                    if (event.data.length === 0) {
                        // No colors were detected in this frame.
                    } else {
                        event.data.forEach(function(rect) {
                        
                        });
                    }
                    });

                    tracking.track('.video', colors);

                    $.get('pt_BR_wordlist.txt').done((palavras) => {
                        AuxiliarDeSugestoesDePalavras(palavras);
                        AuxiliarDeAnotacoes();
                        AuxiliarDePlaca();
        
                        $('.tela__botao_iniciar, .tela__botao_continuar').bind('click', () => {
                            let documentElement = document.documentElement;
                            let requestFullscreen = documentElement.requestFullscreen
                                || documentElement.webkitRequestFullScreen
                                || documentElement.mozRequestFullScreen
                                || documentElement.msRequestFullscreen;
                            requestFullscreen.call(documentElement);
                        })

                        let exibirTelaDoAplicativo = () => {
                            $('.tela__inicio').hide();
                            $('.tela__aplicativo').show();
                            $('.tela__wotao_iniciar').show();
                            $('.tela__botao_continuar').hide();
                        }

                        let exibirTelaInicial = () => {
                            $('.tela__inicio').show();
                            $('.tela__aplicativo').hide();
                            $('.tela__botao_iniciar').hide();
                            $('.tela__botao_continuar').show();
                        }

                        let comecar = () => {
                            Relogio(1500);
                            Relogio(500);
                            //auxiliarDeSugestaoDePalavras.prefixoAnotado('');
                        }

                        let parar = () => {
                            //auxiliarDeTrocaDeArea.parar();
                            PubSub.publish('pararDeAcompanharOTempoACada500Milisegundos');
                            PubSub.publish('pararDeAcompanharOTempoACada1500Milisegundos');
                        }


                        $(document).bind('fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange', () => {
                            let fullScreen = document.isFullScreen || document.webkitIsFullScreen || document.mozFullScreen;
                            if (fullScreen) {
                                comecar();
                                exibirTelaDoAplicativo();
                            } else {
                                parar();
                                exibirTelaInicial();
                            }
                        });

                        $(window).bind('resize orientationchange', () => {
                        
                        });                

                        $('.tela__aplicativo').bind('click', () => {
                            PubSub.publish('deficienteGesticulou');
                        });
                    });
                });
            },

            // errorCallback
            (err) => {
                if(err.message === 'Permission denied') {
                // Explain why you need permission and how to update the permission setting
                }
            }
            );
        });
        </script>
    </head>
    <body class="tela">
        <div class="tela__inicio">
            <div class="tela__conteudo-inicio">
                <h1 class="tela__titulo">Head Typing</h1>
                <button class="tela__botao tela__botao_iniciar">Iniciar</button>            
                <button class="tela__botao tela__botao_continuar">Continuar</button>            
            </div>
        </div>
        <div class="tela__aplicativo">
            <div class="anotacao">
                <span class="anotacao__texto"></span>
            </div>
            <div class="placa">
                <div class="ponteiro"></div>
                <div class="sugestoes"></div>
                <table class="quadro quadro_letras quadro_acentuadas quadro_maiusculas quadro_oculto">
                    <tr class="linha">
                        <td class="celula celula_pequena">Á</td>
                        <td class="celula celula_pequena">Ã</td>
                        <td class="celula celula_pequena">À</td>
                        <td class="celula celula_pequena">É</td>
                        <td class="celula celula_pequena">Ê</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                    <tr class="linha">
                        <td class="celula celula_pequena">Í</td>
                        <td class="celula celula_pequena">Ó</td>
                        <td class="celula celula_pequena">Õ</td>
                        <td class="celula celula_pequena">Ô</td>
                        <td class="celula celula_pequena">Ú</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                </table>
                <table class="quadro quadro_letras quadro_acentuadas quadro_minusculas quadro_oculto">
                    <tr class="linha">
                        <td class="celula celula_pequena">á</td>
                        <td class="celula celula_pequena">ã</td>
                        <td class="celula celula_pequena">à</td>
                        <td class="celula celula_pequena">é</td>
                        <td class="celula celula_pequena">ê</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                    <tr class="linha">
                        <td class="celula celula_pequena">í</td>
                        <td class="celula celula_pequena">ó</td>
                        <td class="celula celula_pequena">õ</td>
                        <td class="celula celula_pequena">ô</td>
                        <td class="celula celula_pequena">ú</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                </table>
                <table class="quadro quadro_letras quadro_nao-acentuadas quadro_maiusculas quadro_oculto">
                    <tr class="linha">
                        <td class="celula celula_pequena">A</td>
                        <td class="celula celula_pequena">E</td>
                        <td class="celula celula_pequena">O</td>
                        <td class="celula celula_pequena">S</td>
                        <td class="celula celula_pequena">R</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                    <tr class="linha">
                        <td class="celula celula_pequena">I</td>
                        <td class="celula celula_pequena">N</td>
                        <td class="celula celula_pequena">D</td>
                        <td class="celula celula_pequena">M</td>
                        <td class="celula celula_pequena">U</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                </table>
                <table class="quadro quadro_letras quadro_nao-acentuadas quadro_maiusculas quadro_oculto">
                    <tr class="linha">
                        <td class="celula">T</td>
                        <td class="celula">C</td>
                        <td class="celula">L</td>
                        <td class="celula">P</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                    <tr class="linha">
                        <td class="celula">V</td>
                        <td class="celula">G</td>
                        <td class="celula">H</td>
                        <td class="celula">Q</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                    <tr class="linha">
                        <td class="celula">B</td>
                        <td class="celula">F</td>
                        <td class="celula">Z</td>
                        <td class="celula">J</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                    <tr class="linha">
                        <td class="celula">X</td>
                        <td class="celula">K</td>
                        <td class="celula">W</td>
                        <td class="celula">Y</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                </table>
                <table class="quadro quadro_letras quadro_nao-acentuadas quadro_minusculas">
                    <tr class="linha">
                        <td class="celula celula_pequena">a</td>
                        <td class="celula celula_pequena">e</td>
                        <td class="celula celula_pequena">o</td>
                        <td class="celula celula_pequena">s</td>
                        <td class="celula celula_pequena">r</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                    <tr class="linha">
                        <td class="celula celula_pequena">i</td>
                        <td class="celula celula_pequena">n</td>
                        <td class="celula celula_pequena">d</td>
                        <td class="celula celula_pequena">m</td>
                        <td class="celula celula_pequena">u</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                </table>
                <table class="quadro quadro_letras quadro_nao-acentuadas quadro_minusculas">
                    <tr class="linha">
                        <td class="celula">t</td>
                        <td class="celula">c</td>
                        <td class="celula">l</td>
                        <td class="celula">p</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                    <tr class="linha">
                        <td class="celula">v</td>
                        <td class="celula">g</td>
                        <td class="celula">h</td>
                        <td class="celula">q</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                    <tr class="linha">
                        <td class="celula">b</td>
                        <td class="celula">f</td>
                        <td class="celula">z</td>
                        <td class="celula">j</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                    <tr class="linha">
                        <td class="celula">x</td>
                        <td class="celula">k</td>
                        <td class="celula">w</td>
                        <td class="celula">y</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                </table>
                <table class="quadro">
                    <tr class="linha">
                        <td class="celula celula_descrita celula_pequena">Espaço</td>
                        <td class="celula celula_descrita celula_maiusculas-minusculas celula_pequena">Maiúsculas</td>
                        <td class="celula celula_descrita celula_acentuadas-nao-acentuadas celula_pequena">Acentuadas</td>
                        <td class="celula celula_descrita celula_pequena">Apagar letra</td>
                        <td class="celula celula_descrita celula_pequena">Apagar palavra</td>                        
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                    <tr class="linha">                        
                        <td class="celula celula_pontuacao celula_pequena">.</td>
                        <td class="celula celula_pontuacao celula_pequena">,</td>
                        <td class="celula celula_pontuacao celula_pequena">?</td>
                        <td class="celula celula_pontuacao celula_pequena">!</td>
                        <td class="celula celula_descrita celula_pequena">Falar e apagar tudo</td>
                        <td class="celula celula_descrita">Continuar</td>
                    </tr>
                </table>
            </div>
        </div>
        <video class="video" preload autoplay loop muted></video>
    </body>
</html>
