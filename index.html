<html>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <head>
        <style>
            #video {
                position: absolute;
                top: 0;
                left: 0;
                margin: 0;
                padding: 0;
                z-index: -1;
                filter: blur(10px);
                filter: saturate(10);
                width: 100vw;
                height: 100vh;
            }
            label {
                display: inline-block;
                font-family: arial;
                font-size: 14pt;
                margin: 5px;
                white-space: nowrap;
                color: gray;
            }
            label * {
                vertical-align: middle;
            }
            label span {
                padding: 5px;
                border-radius: 5px;
            }
            label progress, label input {
                height: 25pt;
            }
            #overlay {
                position: absolute;
                top: 0;
                left: 0;
                margin: 0;
                padding: 0;
                background-color: cornsilk;
                width: 100vw;
                height: 100vh;
            }
            #slider {
                list-style-type: none;
                margin: 0;
                padding: 0;
                height: 50pt;
                overflow: hidden;
                box-shadow: 0px 0px 5px;
                background-color: white;
            }
            #slider * {
                height: 50pt;
                line-height: 50pt;
                font-family: arial;
                text-align: center;
                display: inline-block;
                width: 50pt;
                box-sizing: border-box;
                vertical-align: middle;
                font-size: 16pt;
                border-top-style: solid;
                border-bottom-style: solid;
                border-color: lightgray;
                border-top-width: 1px;
                border-bottom-width: 1px;
                background-color: white;
            }
            #slider *:nth-child(2) {
                border-style: none;
                background-color: orange;
                font-size: 40pt;
            }
            .text {
                margin: 2px 0 0 0;
                resize: none;
                display: inline-block;
                white-space: pre;
                font-size: 14pt;
                height: 14pt;
                font-family: arial;
                background-color: white;
                box-shadow: 0px 0px 10px white;
                padding-top: 10px;
                padding-bottom: 10px;
                border-bottom-style: solid;                
                border-bottom-width: 1px;
                border-bottom-color: gray;
            }
            .broken-line {
                display: block;
            }
            .cursor-active {
                border-right-width: 2px;
                border-right-style: solid;
            }
            #controls {
                box-shadow: 0 0 5px;
                margin: 5px;
                padding: 5px;
                border-radius: 5px;
            }
        </style>

        <link id="wordlist" rel="import" href="/head-typing/pt_BR_wordlist.txt">

        <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.3/moment.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.3/locale/pt-br.js"></script>
        
        <script src="https://cdn.bootcss.com/tracking.js/1.1.3/tracking-min.js"></script>
        <script src="https://cdn.bootcss.com/tracking.js/1.1.3/data/eye-min.js"></script>
        <script src="https://cdn.bootcss.com/tracking.js/1.1.3/data/face-min.js"></script>
        <script src="https://cdn.bootcss.com/tracking.js/1.1.3/data/mouth-min.js"></script>
        
        <script>
        $(() => {
            let video = $('<video>')[0];
            let localizacaoDasLetras = $('<div>');
            let localizacaoDaAnotacao = $('<div>');
            
            $(document.body)            
            .append(localizacaoDasLetras)
            .append(localizacaoDaAnotacao)
            .append(video);

            if(!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
            }

            navigator.mediaDevices.getUserMedia({
                video: {
                    mandatory: {
                        minWidth: 640,
                        minHeight: 480
                    }
                }
            }).then((stream) => {                   
                video.src = window.URL.createObjectURL(stream);
                video.play();               

                let receptor = new Receptor();
                receptor.mostreMeOQueFoiAnotado(localizacaoDaAnotacao);
                receptor.mostreMeAsProximasLetras(localizacaoDasLetras);

                let gesto = new Gesto();
                gesto.detecteEMeAvise(video, () => {
                    receptor.anoteEstaLetra();
                });
            });            
        });
        </script>        
    </head>
    <body>
    </body>
</html>